
var getGeo = function(){
	if(Ti.Geolocation.locationServicesEnabled){
		Ti.Geolocation.purpose = "Get current location";
		Ti.Geolocation.accuracy = Ti.Geolocation.ACCURACY_BEST;
		Ti.Geolocation.distaceFilter = 10;
		Titanium.Geolocation.getCurrentPosition(function(e){
			if(e.error){
				alert("Enable location services" + e.error);
			}else{
				Ti.API.info(e.coords);
				console.log(e.coords);
				var lat = e.coords.latitude;
				var lng = e.coords.longitude;
				var url = "http://api.wunderground.com/api/d1e578e5aa05dc1d/conditions/q/"+lat+","+lng+".json";
				if (Ti.Network.online) {
				     var getData = Ti.Network.createHTTPClient();
				     getData.onload = function(e){
				          console.log(e);  //this is the raw data-string returned from the URL request
				          var weatherArray = JSON.parse(this.responseText);  //convert the string to JS object notation
				          var weatherInfo = {
				          	  loc: weatherArray.current_observation.display_location.full,
				          	  temp: weatherArray.current_observation.temp_c + "ÂºC",
				          	  feelLike: weatherArray.current_observation.feelslike_c,
				          	  weather: weatherArray.current_observation.weather,
				          	  humid: weatherArray.current_observation.relative_humidity
				          };
				          var conditions = json.conditions;
				          var location = json.location;
				          var ui = require("ui");
						  console.log(weatherInfo);	
				          //ui.buildUi(conditions, location);
				     }; //getData.onload closing
				     getData.open("GET", url);
				     getData.send();
				} else {
				     alert("Network currently unavailable.");
				     // load locally stored data perhaps?
				}; // if else Ti.Network closing
			}
		});
	}	
};

exports.getGeo = getGeo;





//______________________________________________\\


// if (Titanium.Geolocation.locationServicesEnabled){
    // Titanium.Geolocation.getCurrentPosition(function(e){
        // Ti.API.info(e.coords);
    // }
// }else{
    // Titanium.UI.createAlertDialog({title:'Location Service', message:'Please turn on your location services.'}).show();
// }


// 
// var getGeo = function(){
		// Ti.Geolocation.getCurrentPosition(function(e){
			// console.log(e);
			// console.log(JSON.stringify(e.source));
			// var lat = e.coords.latitude;
			// var lng = e.cords.longitude;
			// ui.buildUI(lat, lng);
		// });	
// };
// 
// exports.getGeo = getGeo;
// 
// 
// if (Ti.Geolocation.locationServicesEnabled) {
    // Ti.Geolocation.purpose = 'Get Current Location';
    // Ti.Geolocation.accuracy = Ti.Geolocation.ACCURACY_BEST;
    // Ti.Geolocation.distanceFilter = 10;
    // Ti.Geolocation.preferredProvider = Ti.Geolocation.PROVIDER_GPS;
//  
    // Ti.Geolocation.addEventListener('location', function(e) {
        // if (e.error) {
            // alert('Error:' + e.error);
        // } else {
            // Ti.API.info(e.coords);
        // }
    // });
// } else {
    // alert('Please enable location services');
// }










// var getGeo = function(){
	// if (Ti.Geolocation.locationServicesEnabled){
	    // Ti.Geolocation.purpose = "Get Current Location";
	    // Ti.Geolocation.accuracy = Ti.Geolocation.ACCURACY_BEST;
	    // Ti.Geolocation.distanceFilter = 10;
	    // Ti.Geolocation.addEventListener("location", function(e){
	        // if (e.error){
	            // alert("Enable location services" + e.error);
	        // }else{
	        	// Ti.API.info(e.coords);
	        	// var lat = e.coords.latitude;
				// var lng = e.cords.longitude;
			// }	
// }